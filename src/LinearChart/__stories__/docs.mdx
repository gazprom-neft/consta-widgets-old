import {
  LinearChartExampleGeneral,
  LinearChartExampleWithoutGradient,
  //LinearChartExampleNotHorizontal,
  LinearChartExampleLabel,
  LinearChartExampleFormatLabelData,
  LinearChartExampleFormatLabelProcent,
  LinearChartExampleFormatLabelTooltip,
  LinearChartExampleDirectionXtoRight,
  LinearChartExampleDirectionXtoLeft,
  LinearChartExampleDirectionYtoTop,
  LinearChartExampleDirectionYtoBottom,
  LinearChartExampleNull,
  LinearChartExampleBoundaries,
  LinearChartExampleFormatLabel,
  LinearChartExampleZoom,
  LinearChartExampleThreshold,
  LinearChartExampleLinesFeatures
} from './examples/LinearChartExample'

# LinearChart

Линейная диаграмма подходит, если вам нужно описать непрерывный процесс (или несколько)
с большим количеством значений. На такой диаграмме хорошо видно, как значения меняются,
и удобно сравнивать изменения значений в разных процессах.

- [Общие свойства](#общие-свойства-графика)
  - [Название графика](#название-графика)
  - [Единицы измерения](#единицы-измерения)
  - [Фон под графиком](#фон-под-графиком)
  - [Формат подписи к делениям](#формат-подписи-к-делениям)
  - [Тултип](#тултип)
  - [Горизонтальный или вертикальный](#горизонтальный-или-вертикальный)
  - [С зумом](#с-зумом)
- [Линии](#линии)
  - [Координаты точек](#координаты-точек)
  - [Конец и начало линии](#конец-и-начало-линии)
  - [Пропуск части значений](#пропуск-части-значений)
  - [Свойства линии](#свойства-линии)
- [Координатная сетка](#координатная-сетка)
  - [Подписи к делениям](#подписи-к-делениям)
  - [Где показывать](#где-показывать)
  - [Как часто](#как-часто)
  - [Сетка](#сетка)
- [Направление графика](#направление-графика)
- [Предельные значения](#предельные-значения)
- [Лимиты](#лимиты)
- [Список свойств](#список-свойств)
- [Пример-использования](#примеры)

## Общие свойства графика

### Название графика

Название графика можно указать в свойстве `title`.

### Единицы измерения

За единицы измерения по оси ординат отвечает свойство `units`.

### Фон под графиком

Фон под графиком задается в `background`. Фон под линией — в [свойствах линии](#свойства-линии) (за него отвечает `withGradient`).

<LinearChartExampleWithoutGradient />

```tsx
<LinearChart
  title="Название графика"
  lines={

      // описание линии

  }
  gridConfig={

      // описание координатной сетки

  }
  isHorizontal
  unit="единицы"
  background="linear-gradient(to right, #f54d4d48, transparent)"
/>
```

### Формат подписи к делениям

Вы можете определить, в каком формате выводить подпись к делениям, в свойстве `formatValueForLabel`.

По умолчанию рядом с делением выводится его номер на шкале (число в формате `number`).
Но вы можете указать что-то другое: например, дату или процент.

| Добавляет процент к числу                | Выводит значения как даты                                     |
| ---------------------------------------- | ------------------------------------------------------------- |
| <LinearChartExampleFormatLabelProcent /> | <LinearChartExampleFormatLabelData />                         |
| `formatValueForLabel={v =>`\${v} %`}`    | `formatValueForLabel={v => new Date(v).toLocaleDateString()}` |

### Тултип

При наведении на точку на линии показывается тултип — всплывающее окно с дополнительной информацией об этой точке.

Вы можете влиять на два параметра:

- формат заголовка — в нем отображается значение точки по оси `x` (за это отвечает свойство `formatValueForTooltipTitle`),
- формат отображения значения точки по оси `y` в самом тултипе (за это отвечает свойство `formatValueForTooltip`).

Например, здесь в заголовке тултипа поменялся формат даты, а к значению добавили единицы измерения.

<LinearChartExampleFormatLabelTooltip />

```tsx
formatValueForLabel={v => new Date(v).toLocaleDateString()}
formatValueForTooltip={v => `${v} км`}
formatValueForTooltipTitle={v => {
  const title = new Date(v)
    .toLocaleDateString('ru-RU', { month: 'long', year: 'numeric' })
    .replace('г.', '')
  return title[0].toUpperCase() + title.slice(1)
}}
```

Поменять расположение подписей к делениям можно в объекте [`gridConfig`](#координатная-сетка).

### Горизонтальный или вертикальный

Свойство `isHorizontal` рисует график по горизонтали (`x` — ось ординат, `y` — ось абсцисс).
Если укажете в этом свойстве `false`, график повернется на 90 градусов вправо.

<!-- <LinearChartExampleNotHorizontal /> -->

### С зумом

`withZoom` — возможность увеличивать график.

Наведите курсор на конец шкалы по оси абсцисс: увидите значки `[] - +`.

- `+` увеличивает график,
- `-` уменьшает,
- `[]` возвращает к исходному размеру.

Зум будет работать, только если значения `labelTicks` и  `gridTicks` по оси `x` больше 0. [Подробнее о координатной сетке](#координатная-сетка)

<LinearChartExampleZoom />

## Линии

### Координаты точек

На график можно добавить одну или несколько линий. За описание линий отвечает объект `line`.

Опишите координаты линий в объекте `value`. Каждая точка описывается через две координаты:

- `x` — координата по оси абсцисс,
- `y` — координата по оси ординат.

```ts
// values
[
  { x: 1, y: 1 },
  { x: 2, y: 0 },
  { x: 5, y: 3 },
  { x: 7, y: 1 },
  { x: 8, y: 2 },
]
```

#### Конец и начало линии

В точке, в которой нужно прервать линию, укажите `null`. Если укажете `null` в начале или в конце линии, линия прервется в этой точке.

#### Пропуск части значений

Чтобы показать на графике пропуск (обозначается пунктирной линией), укажите координаты точек, а между ними в промежуточных значениях добавьте `null`.

<LinearChartExampleNull />

```ts
// values
[
  { x: 0, y: null },
  { x: 1, y: 1 },
  { x: 2, y: 0 },
  { x: 3, y: null },
  { x: 4, y: null },
  { x: 5, y: 3 },
  { x: 6, y: null },
  { x: 7, y: 1 },
  { x: 8, y: 2 },
  { x: 9, y: null },
]
```

### Свойства линии

За свойства линий отвечает объект `lines`. В него можно добавить несколько линий.

Название линии указывается в свойстве `lineName`.

Цвет линии указывается в свойстве `color`.

Чтобы показать точки на линии в явном виде, добавьте `dots=ture`.

Чтобы рядом с точками вывести значения, добавьте `showValues=true`
(работает корректно, только если в `gridConfig` указать `withPaddings = true`).

Чтобы добавить градиент к линии, укажите `withGradient=true`.

`withBoundaries` — показывает лимиты на линиях и на графике. [Подробнее про лимиты](#лимиты)

<LinearChartExampleLinesFeatures />

```ts
[
  {
    values: [
      { x: 0, y: 0 },
      { x: 1, y: 1 },
      { x: 2, y: 0 },
      { x: 5, y: 3 },
      { x: 7, y: 1 },
      { x: 9, y: 3 },
    ],
    dots: true,
    showValues: true,
    lineName: 'Красивая синяя линия',
    withGradient: true,
    color: 'var(--color-bg-normal)'
  },
]
```

## Координатная сетка

За координатную сетку отвечает `gridConfig`. Свойства указываются отдельно для каждой оси.

### Подписи к делениям

Подписи к делениями могут быть любыми. Вы можете определить их формат и расположить где и как удобно.

#### Где показывать

Свойство `labels` отвечает за расположение подписей по отношению к графику. Варианты:

- для `x` — `'left'` или `'right'`,
- для `y`— `'top'` или `'bottom'`.

| `left` и `bottom`             | `top` и `right`             |
| ----------------------------- | --------------------------- |
| <LinearChartExampleGeneral /> | <LinearChartExampleLabel /> |

Если не укажете, подписи у делений на графике пропадут.

#### Как часто

`labelTicks` задает номер деления, у которого будет стоять подпись.
Если укажете 1, подписи будут стоять у всех делений, 2 — у каждого второго, 3 — у каждого третьего.

### Сетка

В `gridTicks` можно указать количество делений, которые вы хотите показать на графике.
Правда, количество делений, которое появится на графике в итоге, может быть больше или меньше:
его подбирает алгоритм.

`guide` рисует ось координат (саму линию).

`withPaddings` делает график немного больше, чтобы показать, что он продолжается дальше.

```ts
{
  "x": {
    "labels": "bottom",
    "labelTicks": 1,
    "gridTicks": 10,
    "guide": true,
    "withPaddings": false
  },
  "y": {
    "labels": "left",
    "labelTicks": 1,
    "gridTicks": 4,
    "guide": true,
    "withPaddings": false
  }
}
```

## Направление графика

Вы можете перевернуть график по горизонтали или по вертикали.

`directionX` разворачивает график по горизонтали. Варианты:

- `'toRight'` — обычное направление, слева направо,
- `'toLeft'` — обратное направление, справа налево.

| `directionX=toRight`                    | `directionX=toLeft`                    |
| --------------------------------------- | -------------------------------------- |
| <LinearChartExampleDirectionXtoRight /> | <LinearChartExampleDirectionXtoLeft /> |

`directionY` разворачивает график по вертикали. Варианты:

- `'toTop'` — обычное направление.
- `'toBottom'` — обратное направление.

| `directionY=toTop`                    | `directionX=toBottom`                    |
| ------------------------------------- | ---------------------------------------- |
| <LinearChartExampleDirectionYtoTop /> | <LinearChartExampleDirectionYtoBottom /> |

## Предельные значения

За область предельных значений отвечает объект `threshold`.

Максимальные значения задаются в свойстве `max` (это обязательно), минимальные — в свойстве `min`.

```ts
{
  "max": {
    "values": [
      {
        "x": 1604651388343,
        "y": 6
      },
      {
        "x": 1604737788343,
        "y": 6
      }
    ]
  },
  "min": {
    "values": [
      {
        "x": 1604651388343,
        "y": 1
      },
      {
        "x": 1604737788343,
        "y": 1
      }
    ]
  }
}
```

<LinearChartExampleThreshold />

## Лимиты

Вы можете выделить на линиях области значений, которые попадают под ограничения.

Указать ограничения можно в объекте `boundaries`:

- в `value` укажите два числа — начало и конец ограничения,
- в `color` — цвет, которым выделяется линия, попадающая в эту область значений.

```ts
[
  {
    "value": [ -25, -35 ],
    "color": "var(--color-bg-caution)"
  },
  {
    "value": [ -35, -51],
    "color": "var(--color-bg-alert)"
  },
  {
    "value": [ 35, 51 ],
    "color": "var(--color-bg-alert)"
  },
  {
    "value": [ 25, 35 ],
    "color": "var(--color-bg-caution)"
  },
  {
    "value": [ 25, -25 ],
    "color": "var(--color-bg-success)"
  }
]
```

`boundariesAxis` указывает ось, по которой будут считаться ограничения. Варианты: `'x'` или `'y'`.

Если хотите показать цветом границы ограничений на линии оси, добавьте `showBoundariesOnAxis=true`.

<LinearChartExampleBoundaries />

## Свойства

<!-- props:start -->

| Свойство                                             | Тип                         | По умолчанию | Описание                                                                        |
| ---------------------------------------------------- | --------------------------- | ------------ | ------------------------------------------------------------------------------- |
| [`directionX?`](#направление-графика)                | `'toRight'`, `'toLeft'`     | `'toRight'`  | Разворачивает график по горизонтали                                             |
| [`directionY?`](#направление-графика)                | `'toTop'`, `'toBottom'`     | `'toTop'` | Разворачивает график по вертикали                                               |
| [`lines`](#свойства-линии)                           | [`Line[]`](#line)           | -            | Объект для описания линий                                                       |
| [`gridConfig`](#координатная-сетка)                  | [`GridConfig`](#gridconfig) | -            | Объект для описания координатной сетки                                          |
| [`threshold?`](#предельные-значения)                  | [`Threshold`](#threshold)   | -            | Объект для описания предельных значений                                          |
| [`withZoom?`](#с-зумом)                              | `boolean`                   | -            | Показывает контролы для увеличения и уменьшения графика                         |
| [`isHorizontal`](#горизонтальный-или-вертикальный)   | `boolean`                   | -            | Показывает график в горизонтальном или вертикальном виде                        |
| [`formatValueForLabel?`](#формат-подписи-к-делениям) | `(value: number) => string` | -            | Формат подписи к делению                                                        |
| [`formatValueForTooltip?`](#тултип)                  | `(value: number) => string` | -            | Формат подписи к делению для тултипа                                            |
| [`formatValueForTooltipTitle?`](#тултип)             | `(value: number) => string` | -            | Формат заголовка в тултипе                                                      |
| [`unit?`](#общие-свойства-графика)                   | `string`                    | -            | Единицы измерения для оси абсцисс                                               |
| [`title?`](#название-графика)                        | `React.ReactNode`           | -            | Название графика                                                                |
| `onClickHoverLine?`                                  | `(value: number) => void`   | -            | Действие по клику на линию                                                      |
| [`background?`](#фон-под-графиком)                   | `string`                    | -            | Фон под графиком                                                                |
| [`boundaries?`](#лимиты)                             | `Boundary[]`                | -            | Объект с описанием лимитов                                                      |
| [`boundariesAxis?`](#лимиты)                         | `'x'`, `'y'`                | -            | Ось, по которой считаются лимиты                                                |
| [`showBoundariesOnAxis`](#лимиты)                    | `boolean`                   | -            | Добавляет отображение лимитов на координатную ось, выбранную в `boundariesAxis` |

### Line

| Ключ                                 | Тип               | По умолчанию | Описание                                                  |
| ------------------------------------ | ----------------- | ------------ | --------------------------------------------------------- |
| [`values`](#координаты-точек)        | `readonly Item[]` | -            | Набор координат для построения графика                    |
| [`lineName`](#свойства-линии)        | `string`          | -            | Название линии на графике                                 |
| [`color`](#свойства-линии)           | `string`          | -            | Цвет линии                                                |
| [`dots?`](#свойства-линии)           | `boolean`         | -            | Показывает точки на линии в явном виде                    |
| [`showValues?`](#свойства-линии) | `boolean`         | -            | Выводит значение рядом с точкой. Корректно работает, если в свойстве [`withPaddings`](#gridconfig) указано `true`  |
| [`withGradient?`](#свойства-линии)   | `boolean`         | -            | Добавляет градиент под линией                             |
| [`withBoundaries?`](#свойства-линии) | `boolean`         | -            | Добавляет отображение лимитов на линию (если они указаны) |

#### Line —> values

| Ключ                     | Тип      | По умолчанию | Описание                  |
| ------------------------ | -------- | ------------ | ------------------------- |
| [`x`](#координаты-точек) | `number` | -            | Координата по оси абсцисс |
| [`y`](#координаты-точек) | `number` | -            | Координата по оси ординат |

### GridConfig

Указывается по осям — отдельно для `x` и `y`.

| Ключ                                 | Тип                              | По умолчанию | Описание                                                                                                     |
| ------------------------------------ | -------------------------------- | ------------ | ------------------------------------------------------------------------------------------------------------ |
| [`labels?`](#подписи-к-делениям)     | `top`, `bottom`, `left`, `right` | -            | Где показывать подписи к делениям координатной сетки. Сверху или снизу — для `x`, слева или справа — для `y` |
| [`labelTicks?`](#подписи-к-делениям) | `string`                         | -            | Как часто ставить подписи к делениям (у каждого, у каждого второго и т. д.)                                                               |
| [`gridTicks?`](#сетка)               | `string`                         | -            | Количество делений, которые видны на графике                                                                 |
| [`guide?`](#сетка)                   | `boolean`                        | -            | Рисует линию оси                                                                                             |
| [`withPaddings?`](#сетка)            | `boolean`                        | -            | Немного увеличивает график, чтобы можно было показать, что линия продолжается дальше                         |

### Threshold

| Ключ                          | Тип      | По умолчанию | Описание                                                           |
| ----------------------------- | -------- | ------------ | ------------------------------------------------------------------ |
| [`max`](#предельные-значения)  | `Item[]` | -            | Массив с координатами точек, описывающий верхний порог ограничений |
| [`min?`](#предельные-значения) | `Item[]` | -            | Массив с координатами точек, описывающий нижний порог ограничений  |

### boundaries —> values

| Ключ               | Тип                | По умолчанию | Описание                     |
| ------------------ | ------------------ | ------------ | ---------------------------- |
| [`color`](#ссылка) | `string`           | -            | Цвет для области ограничений |
| [`value`](#ссылка) | `[number, number]` | -            | Границы области ограничений  |

## Примеры

```tsx
import { LinearChart } from '@consta/widgets/LinearChart'

<LinearChart
  lines={[
    {
      values: [
        { x: 0, y: 0 },
        { x: 1, y: 1 },
        { x: 2, y: 0 },
        { x: 3, y: 2 },
        { x: 4, y: 4 },
        { x: 5, y: 3 },
        { x: 6, y: 2 },
        { x: 7, y: 1 },
        { x: 8, y: 2 },
        { x: 9, y: 5 },
      ],
      dots: true,
      lineName: 'Северный бур',
      withGradient: true,
      color: colors.first,
    },
  ]}
  gridConfig={{
    x: {
      labels: 'bottom',
      labelTicks: 1,
      gridTicks: 10,
      guide: true,
      withPaddings: false,
    },
    y: {
      labels: 'left',
      labelTicks: 1,
      gridTicks: 4,
      guide: true,
      withPaddings: false,
    },
  }}
  formatValueForLabel={String}
  isHorizontal
  withZoom
  unit="тыс м3"
  background="linear-gradient(to right, #f54d4d48, transparent)"
  directionX="toRight"
  directionY="toTop"
/>
```
