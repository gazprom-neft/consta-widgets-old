import { RoadmapExample, RoadmapExampleFilters } from './examples/RoadmapExample'

# Roadmap

Этот компонент можно использовать для планирования. Показывает текущее состояние проекта:
какие задачи запланированы и как они выполняются на самом деле.

<RoadmapExampleFilters />

- [Даты](#даты)
- [Столбцы](#столбцы)
- [Строки](#строки)
  - [Описание задачи](#описание-задачи)
- [Фильтры](#фильтры)
- [Список свойств](#свойства)
- [Пример использования](#пример)

## Даты

Период планирования можно задать с помощью двух дат:
`startDate` — начало, `endtDate` — конец.

Сегодняшний день указывается в `currentDay`.

<RoadmapExample />

## Столбцы

Перед таблицей с планами можно добавить столбцы (хотя бы один — обязательно) с пояснениями, о каких планах идет речь.

`title` — название столбца (это заголовок в таблице).

`accessor` — идентификатор столбца, по нему задается содержимое ячеек в этом столбце, когда описываются строки.

`width` — ширина столбца в пикселях.

`align` — выравнивание текста в этом столбце. Варианты: `'left'`, `'right'` или `'center'` , по умолчанию `'left'`.

<RoadmapExample />

```ts
// columns
[
  {
    title: 'Что строим',
    accessor: 'building',
    width: 150,
  },
  {
    title: 'Кто строит',
    accessor: 'builder',
    align: 'center',
    width: 120,
  },
]
```

## Строки

За содержание строк отвечает свойство `rows`.

`id` — идентификатор строки.

Чтобы указать содержимое ячеек в столбцах, которые вы задали в `columns`,
используйте идентификаторы столбцов.

Например, если есть два столбца с идентификаторами `building` и `builder` (указываются в свойстве `accessor`),
содержимое ячеек в первой строке можно описать вот так:

```ts
building: 'Дом для крокодила',
builder: 'Чебурашка'
```

<RoadmapExample />

### Описание задачи

Задачи, которые нужно показать в этой строке, описываются в свойстве `groups`.

Название задачи можно указать в `title`, дополнительную информацию — в `comment`
(и название, и комментарий будут видны только в тултипе).

Цвет линии, которая обозначает задачу, указывается в свойстве `color`.

Данные для планирования:

- `plan` — период, в который задачу нужно выполнить (план, бледная линия),
- `fact` — период, за который ее на самом деле выполнили (реальность, яркая линия того же цвета),
- `forecast` — период, за который задачу планируется выполнить по факту (прогноз, бледная линия, продолжает план после текущей даты). Прогноз можно не описывать.

Внутри любого периода две даты: `startDate` — начало периода, `endDate` — конец.

На графике видны линии — отражение планов и реальности.
Чтобы посмотреть подробную информацию о задаче, нажмите на активную линию:
появится тултип со всеми данными.

<RoadmapExample />

```ts
{
  id: 'row2',
  building: 'Будка для крысы',
  builder: 'Шапокляк',
  groups: [
    {
      title: 'Фундамент',
      plan: {
        startDate: Date.UTC(2020, 0, 1),
        endDate: Date.UTC(2020, 2, 5),
      },
      fact: {
        startDate: Date.UTC(2020, 0, 1),
        endDate: Date.UTC(2020, 1, 20),
      },
      color: 'var(--color-bg-success)',
    },
    {
      title: 'Стены',
      plan: {
        startDate: Date.UTC(2020, 2, 5),
        endDate: Date.UTC(2020, 3, 1),
      },
      fact: {
        startDate: Date.UTC(2020, 1, 20),
        endDate: Date.UTC(2020, 3, 10),
      },
      forecast: {
        startDate: Date.UTC(2020, 1, 20),
        endDate: Date.UTC(2020, 3, 22),
      },
      comment:
        'Задерживаемся: проблемы с кирпичами',
      color: '#A13DFF',
    },
  ],
}
```

## Фильтры

Фильтр появляется рядом с заголовком столбца и позволяет выбрать часть строк —
только те, в которых встречается нужное значение.

Вы можете добавить фильтры в любой столбец, который описали в `columns`.
Это можно сделать в свойстве `filters`. Что внутри:

- `id` — идентификатор фильтра,
- `name` — название, которое можно будет выбрать в фильтре,
- `filterer` — содержимое, строки с которым нужно показывать,
- `field` — идентификатор столбца, в который нужно добавить фильтр.

```ts
{
  id: 'cheb',
  name: 'Выбрать Чебурашку',
  filterer: (value: string) => value === 'Чебурашка',
  field: 'builder',
}
```

<RoadmapExampleFilters />

## Свойства

<!-- props:start -->

| Свойство               | Тип                           | По умолчанию | Описание                   |
| ---------------------- | ----------------------------- | ------------ | -------------------------- |
| [`columns`](#столбцы)  | [`Column[]`](#column)         | -            | Массив с описанием колонок |
| [`rows`](#строки)      | [`RoadmapRow[]`](#roadmaprow) | -            | Массив с описанием строк   |
| [`currentDay`](#даты)  | `number`                      | -            | Сегодня (текущая дата)     |
| [`startDate`](#даты)   | `number`                      | -            | Начало планирования        |
| [`endDate`](#даты)     | `number`                      | -            | Конец планирования         |
| [`filters?`](#фильтры) | `TableFilters<TableRow>`      | -            | Фильтры                    |
| `title?`               | `React.ReactNode`             | -            | Заголовок                  |

### Column

| Свойство               | Тип                             | По умолчанию | Описание                      |
| ---------------------- | ------------------------------- | ------------ | ----------------------------- |
| [`title`](#столбцы)    | `string`                        | -            | Название столбца              |
| [`accessor`](#столбцы) | `string`                        | -            | Идентификатор столбца         |
| [`width`](#столбцы)    | `number`                        | -            | Ширина столбца в пикселях     |
| [`align?`](#столбцы)   | `'left'`, `'right'`, `'center'` | `'left'`     | Выравнивание текста в столбце |

### RoadmapRow

| Свойство            | Тип       | По умолчанию | Описание                  |
| ------------------- | --------- | ------------ | ------------------------- |
| [`id`](#строки)     | `string`  | -            | Идентификатор строки      |
| [`groups`](#строки) | `Group[]` | -            | Массив с описанием задачи |

#### Group

| Свойство                        | Тип      | По умолчанию | Описание                     |
| ------------------------------- | -------- | ------------ | ---------------------------- |
| [`title?`](#описание-задачи)    | `string` | -            | Название задачи              |
| [`color`](#описание-задачи)     | `string` | -            | Цвет задачи                  |
| [`plan?`](#описание-задачи)     | `Item[]` | -            | План выполнения задачи       |
| [`fact?`](#описание-задачи)     | `Item[]` | -            | Реальное выполнение задачи   |
| [`forecast?`](#описание-задачи) | `Item[]` | -            | Прогноз по выполнению задачи |
| [`comment?`](#описание-задачи)  | `string` | -            | Комментарий к задаче         |

#### Item

| Свойство                        | Тип      | По умолчанию | Описание    |
| ------------------------------- | -------- | ------------ | ----------- |
| [`startDate`](#описание-задачи) | `number` | -            | Дата начала |
| [`endDate`](#описание-задачи)   | `number` | -            | Дата конца  |

### Filter

| Свойство               | Тип      | По умолчанию | Описание                                      |
| ---------------------- | -------- | ------------ | --------------------------------------------- |
| [`id`](#фильтры)       | `string` | -            | Идентификатор фильтра                         |
| [`name`](#фильтры)     | `string` | -            | Название в фильтре                            |
| [`field`](#фильтры)    | `sting`  | -            | Идентификатор столбца, в котором нужен фильтр |
| [`filterer`](#фильтры) | `string` | -            | Поле, по которому нужно фильтровать           |

## Пример

```tsx
import { Roadmap } from '@consta/widgets/Roadmap'

<Roadmap
  rows={[
    {
      id: 'row2',
      building: 'Будка для крысы',
      builder: 'Шапокляк',
      groups: [
        {
          title: 'Фундамент',
          plan: {
            startDate: Date.UTC(2020, 0, 1),
            endDate: Date.UTC(2020, 2, 5),
          },
          fact: {
            startDate: Date.UTC(2020, 0, 1),
            endDate: Date.UTC(2020, 1, 20),
          },
          color: 'var(--color-bg-success)',
        },
        {
          title: 'Стены',
          plan: {
            startDate: Date.UTC(2020, 2, 5),
            endDate: Date.UTC(2020, 3, 1),
          },
          fact: {
            startDate: Date.UTC(2020, 1, 20),
            endDate: Date.UTC(2020, 3, 10),
          },
          forecast: {
            startDate: Date.UTC(2020, 1, 20),
            endDate: Date.UTC(2020, 3, 22),
          },
          comment: 'Задерживаемся: проблемы с кирпичами',
          color: '#A13DFF',
        },
      ],
    },
  ]}
  columns={[
    {
      title: 'Что строим',
      accessor: 'building',
      width: 150,
    },
    {
      title: 'Кто строит',
      accessor: 'builder',
      align: 'center',
      width: 120,
    },
  ]}
  filters={[
    {
      id: 'cheb',
      name: 'Выбрать Чебурашку',
      filterer: (value: string) => value === 'Чебурашка',
      field: 'builder',
    },
  ]}
  startDate={Date.UTC(2020, 0, 1)}
  currentDate={Date.UTC(2020, 3, 10)}
  endDate={Date.UTC(2020, 3, 10)}
/>
```
